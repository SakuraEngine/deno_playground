## 环境容器

程序(尤其是工具链)的运行一般依赖运行环境, 例如 VC 工具链就依赖 vcvars.bat 设置的一系列环境. 但是环境管理本身并不统一, 主要体现在两部分:

- 操作系统和 shell 语法不统一, 每个 os 的 env 脚本设计不同, 每个 os 的默认 shell 不同, 每个 shell 的语法也不同;
- 工具链会针对不同 shell 提供不同的工具, 例如 vcvars 就只能在 cmd 启动, 而 ps 是注入一个程序(且需要设置脚本权限);

考虑到跨 Shell、跨平台以及完备的环境管理

- 环境容器有多种生成方式, 可以从脚本逻辑构建, 可以被不同的 shell 输出;
    - 例如 vcvars 需要启动 cmd 运行一次, 随后通过 'set>$(file)'输出到某个流, 再序列化成环境容器;
    - 上述这个情况是 cmd 这个 shell 运行了某个程序后 Dump Env 的一种过程;
- 环境容器可以布尔运算(是个字典);
- 可以被 Shell 设置到环境里;

**一些设置变量, 例如使用的 WinSDKVer, 是不是也直接设置到 build system 的运行环境比较好?**

## Shell

- 操作系统默认的 Shell, 例如 windows 的 %comspec%，MacOS 的 zsh，发行版则各有不同；
- 构建系统默认的 Shell，这往往是我们通过综合评判选取问题最少的那个；
- 覆盖指定的 Shell，有些程序和脚本只能运行在特定的 Shell 上；